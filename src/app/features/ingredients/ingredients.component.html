<div class="ingredients-container">
  <div class="header">
    <h1>ü•¨ Mes Ingr√©dients</h1>
    <button class="btn btn-primary" (click)="openAddForm()">+ Ajouter un ingr√©dient</button>
  </div>

  <div class="filters-section">
    <div class="search-box">
      <input
        type="text"
        class="search-input"
        placeholder="Rechercher un ingr√©dient..."
        [(ngModel)]="searchQuery"
        (input)="onSearch()"
      />
    </div>

    <div class="category-filter">
      <select class="filter-select" [(ngModel)]="selectedCategory" (change)="onCategoryChange()">
        <option value="">-- Toutes les cat√©gories --</option>
        <option *ngFor="let cat of categories" [value]="cat">{{ cat }}</option>
      </select>
    </div>
  </div>

  <div
    *ngIf="showForm()"
    class="modal-overlay"
    (click)="closeForm()"
    role="presentation"
    tabindex="-1"
  >
    <div class="modal-content" (click)="$event.stopPropagation()" role="presentation" tabindex="-1">
      <app-ingredient-form
        [ingredient]="selectedIngredient()"
        (save)="onSaveIngredient($event)"
        (cancel)="closeForm()"
      ></app-ingredient-form>
    </div>
  </div>

  <div class="ingredients-table-container">
    <div *ngIf="filteredIngredients.length === 0" class="empty-state">
      <p>Aucun ingr√©dient trouv√©.</p>
    </div>

    <table class="ingredients-table" *ngIf="filteredIngredients.length > 0">
      <thead>
        <tr>
          <th>Nom</th>
          <th>Cat√©gorie</th>
          <th>Unit√©</th>
          <th>Calories (100g)</th>
          <th>Prot√©ines</th>
          <th>Glucides</th>
          <th>Lipides</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let ingredient of filteredIngredients" class="ingredient-row">
          <td class="ingredient-name">{{ ingredient.name }}</td>
          <td class="ingredient-category">
            <span class="category-badge">{{ ingredient.category }}</span>
          </td>
          <td>{{ ingredient.unit }}</td>
          <td>{{ ingredient.calories || '-' }} kcal</td>
          <td>{{ ingredient.protein || '-' }}g</td>
          <td>{{ ingredient.carbs || '-' }}g</td>
          <td>{{ ingredient.fats || '-' }}g</td>
          <td class="actions-cell">
            <button class="btn btn-small btn-secondary" (click)="openEditForm(ingredient)">
              Modifier
            </button>
            <button class="btn btn-small btn-danger" (click)="onDeleteIngredient(ingredient.id!)">
              Supprimer
            </button>
          </td>
        </tr>
      </tbody>
    </table>
  </div>
</div>
