<div class="search-container">
  <div class="header">
    <h1>üîç Rechercher une recette</h1>
  </div>

  <div class="search-section">
    <div class="search-box">
      <input
        type="text"
        class="search-input"
        placeholder="Entrez un mot-cl√©..."
        [(ngModel)]="searchQuery"
        (input)="onSearch()"
      />
    </div>

    <div class="search-filters">
      <label for="searchBy">Rechercher par :</label>
      <select id="searchBy" class="filter-select" [(ngModel)]="searchBy" (change)="onSearch()">
        <option value="all">Partout</option>
        <option value="name">Nom</option>
        <option value="category">Cat√©gorie</option>
      </select>
    </div>
  </div>

  <div class="results-container">
    @if (recipes().length === 0) {
      <div class="empty-state">
        <p>
          {{
            searchQuery()
              ? 'Aucune recette trouv√©e.'
              : 'Commencez une recherche pour voir les r√©sultats.'
          }}
        </p>
      </div>
    }

    @if (recipes().length > 0) {
      <div class="results-info">
        <p>{{ recipes().length }} recette(s) trouv√©e(s)</p>
      </div>
    }

    <div class="recipes-list">
      @for (recipe of recipes(); track $index) {
        <div
          class="recipe-result"
          (click)="viewRecipe(recipe)"
          (keypress)="viewRecipe(recipe)"
          tabindex="0"
        >
          <div class="recipe-header">
            <h3>{{ recipe.name }}</h3>
            <span class="category-badge">{{ recipe.category }}</span>
          </div>

          <p class="recipe-description">{{ recipe.description }}</p>

          <div class="recipe-meta">
            <span class="meta-item">
              <strong>‚è±Ô∏è Temps total :</strong> {{ getTotalTime(recipe) }} min
            </span>
            <span class="meta-item"> <strong>üë• Portions :</strong> {{ recipe.servings }} </span>
          </div>

          <div class="recipe-stats">
            <span class="stat">
              <strong>Ingr√©dients :</strong> {{ recipe.ingredients?.length }}
            </span>
            <span class="stat"> <strong>√âtapes :</strong> {{ recipe.steps?.length }} </span>
          </div>

          @if(selectedRecipe() === recipe) {
            <div class="recipe-detail">
              <div class="detail-section">
                <h4>Ingr√©dients</h4>
                <ul>
                  @for(ingredient of recipe.ingredients; track ingredient.ingredientId) {
                    <li>
                      {{ getIngredientName(ingredient.ingredientId) }} - {{ ingredient.quantity }}
                      {{ ingredient.unit }}
                    </li>
                  }
                </ul>
              </div>
  
              <div class="detail-section">
                <h4>Pr√©paration</h4>
                <ol>
                  @for (step of recipe.steps; track step) {
                    <li>
                      {{ step }}
                    </li>
                  }
                </ol>
              </div>
  
              <button class="btn btn-secondary" (click)="closeDetail()">Fermer</button>
            </div>
          }
        </div>
      }
    </div>
  </div>
</div>
