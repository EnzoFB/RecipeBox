<div class="ingredients-container">
  <div class="header">
    <h1>ü•¨ Gestion des Ingr√©dients</h1>
    <button mat-raised-button color="primary" (click)="openAddForm()">+ Ajouter un ingr√©dient</button>
  </div>

  <div class="filters-section">
    <div class="search-box">
      <input
        type="text"
        class="search-input"
        placeholder="Rechercher un ingr√©dient..."
        [(ngModel)]="searchQuery"
        (input)="onSearch()"
      />
    </div>

    <div class="category-filter">
      <select class="filter-select" [(ngModel)]="selectedCategory" (change)="onCategoryChange()">
        <option value="">-- Toutes les cat√©gories --</option>
        <option *ngFor="let cat of categories" [value]="cat">{{ cat }}</option>
      </select>
    </div>
  </div>

  <div class="ingredients-grid">
    <div *ngIf="filteredIngredients.length === 0" class="empty-state">
      <p>Aucun ingr√©dient trouv√©.</p>
    </div>

    @for(ingredient of filteredIngredients; track ingredient.id) {
      <mat-card class="ingredient-card">
        <div class="ingredient-image">
          @if (ingredient.image) {
            <img [src]="ingredient.image" [alt]="ingredient.name" class="ingredient-photo" />
          } @else {
            <div class="ingredient-placeholder">
              <span class="placeholder-icon">ü•ï</span>
            </div>
          }
        </div>
        <mat-card-header>
          <h3>{{ ingredient.name }}</h3>
          <span class="category-badge">{{ ingredient.category }}</span>
        </mat-card-header>
        <mat-card-content>
          <div class="ingredient-info">
            <span class="info-item">
              <strong>Unit√©:</strong> {{ ingredient.unit }}
            </span>
            <span class="info-item">
              <strong>Calories (100g):</strong> {{ ingredient.calories || '-' }} kcal
            </span>
          </div>
          <div class="ingredient-nutrition">
            <div class="nutrition-item">
              <span class="label">Prot√©ines</span>
              <span class="value">{{ ingredient.protein || '-' }}g</span>
            </div>
            <div class="nutrition-item">
              <span class="label">Glucides</span>
              <span class="value">{{ ingredient.carbs || '-' }}g</span>
            </div>
            <div class="nutrition-item">
              <span class="label">Lipides</span>
              <span class="value">{{ ingredient.fats || '-' }}g</span>
            </div>
          </div>
        </mat-card-content>
        <mat-card-actions>
          <button mat-button (click)="openEditForm(ingredient)">
            Modifier
          </button>
          <button mat-button color="warn" (click)="onDeleteIngredient(ingredient.id!)">
            Supprimer
          </button>
        </mat-card-actions>
      </mat-card>
    }
  </div>
</div>
